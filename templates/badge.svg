{% if badge.bartxt == '' %}
<svg
  viewBox="0 0 {{badge.size}} {{badge.size}}"
  width="{{badge.size}}px"
  height="{{badge.size}}px"
  xmlns="http://www.w3.org/2000/svg"
>
  <foreignObject
    x="0"
    y="0"
    width="{{badge.size}}"
    height="{{badge.size}}"
  >
{% else %}
<svg
  viewBox="0 0 {{badge.size+badge.barlen+14}} {{badge.size+3}}"
  width="{{badge.size+badge.barlen+14}}px"
  height="{{badge.size+3}}px"
  xmlns="http://www.w3.org/2000/svg"
>
  <foreignObject
    x="0"
    y="0"
    width="{{badge.size+badge.barlen+14}}"
    height="{{badge.size+3}}"
  >
{% endif %}
    <html xmlns="http://www.w3.org/1999/xhtml">
      <style>
        {% if badge.font_b64 %}
        @font-face {
          font-family: 'CustomFont';
          src: url('{{badge.font_b64}}') format('truetype');
        }
        {% endif %}
        .container {
          display: flex;
          align-items: center;
          flex-direction: row-reverse;
          width: 100%;
          height: 100%;
        }
        .img {
          border-radius: {{badge.radius}}px;
          background-image: url('{{badge.b64}}');
          background-size: cover;
          background-color: #fff;
          width: {{badge.size-2*badge.border}}px;
          height: {{badge.size-2*badge.border}}px;
          margin: {{badge.border}}px {% if badge.bartxt == '' %}{{badge.border}}{% else %}-{{(badge.size-2*badge.border)/2}}{% endif %}px {{badge.border}}px {{badge.border}}px;
          box-shadow: 0px 0px {{badge.border}}px rgba(0,0,0,{{badge.shadow}});
          z-index: 2;
          flex: none;
        }
        .bar {
          border-radius: 0 {{badge.barradius}}px {{badge.barradius}}px 0;
          font-weight: 1000;
          display: flex;
          align-items: center;
          overflow: hidden;
          font-family: {% if badge.font_b64 %}'CustomFont', {% endif %}"HarmonyOS","Helvetica Neue","Luxi Sans","DejaVu Sans","Hiragino Sans GB","Microsoft Yahei",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Noto Color Emoji","Segoe UI Symbol","Android Emoji","EmojiSymbols" !important;
          height: {{(badge.size-2*badge.border)*1}}px;
          flex: 1;
          background: linear-gradient({{badge.direction}}, {{badge.colors_str}});
          box-shadow: 0px 0px {{badge.border}}px rgba(0,0,0,{{badge.shadow}});
          white-space: nowrap;
          margin: {{badge.border}}px 0;
          margin-right: {{badge.border}}px;
          padding-left: {{badge.size/2+5}}px;
          font-size: {{badge.fontsize+1}}px;
          z-index: 1;
        }
        .shadow {
          position: absolute;
          text-shadow: 0.8px 0.8px 1px rgba(0, 0, 0, 0.5);
          z-index: 0;
        }
        @keyframes move {
          from { width: 0px; }
          to { width: {{badge.barlen-badge.border+5}}px; }
        }
        .bar {
          animation-duration: {{badge.anime}}ms;
          animation-name: move;
          animation-fill-mode: both;
        }
        span {
          background: linear-gradient({{badge.fontway}}, {{badge.fontcolor}});
          background-clip: text;
          -webkit-background-clip: text;
          color: transparent;
          margin-bottom: 1.5px;
          z-index: 1;
        }
      </style>
      <div class="container">
      {% if badge.bartxt != '' %}
        <div class="bar">
          <span class="shadow">{{badge.bartxt}}</span>
          <span>{{badge.bartxt}}</span>
        </div>
      {% endif %}
        <div class="img"></div>
      </div>
    </html>
  </foreignObject>
</svg>